CREATE TABLE FAFILE (
	fiID INT NOT NULL CONSTRAINT FAFILE_PK PRIMARY KEY,
	fiNAME VARCHAR(260), 
	fiEXTENSION VARCHAR(5) NOT NULL, 
	fiACTIVE SMALLINT
);
					
CREATE TABLE FILERECORD (
    frID INT NOT NULL GENERATED ALWAYS AS IDENTITY 
    (START WITH 1, INCREMENT BY 1) CONSTRAINT FILERECORD_PK PRIMARY KEY,
	frfiID INT NOT NULL, 
	frPATH VARCHAR(210), 
	frSIZE INT NOT NULL, 
	frMOD_DATE TIMESTAMP NOT NULL,
	CONSTRAINT frfiID_fk FOREIGN KEY (frfiID) REFERENCES FAFILE(fiID) 
);

CREATE TABLE SUMMARYRECORD (
    srID INT NOT NULL GENERATED ALWAYS AS IDENTITY 
    (START WITH 1, INCREMENT BY 1) CONSTRAINT SUMMARYRECORD_PK PRIMARY KEY,
    srDateTimeCheck TIMESTAMP  NOT NULL,
    srNumFiles INT  NOT NULL,
    srDiskSpace INT  NOT NULL,
    srNumFilesAdded INT  NOT NULL,
    srNumFilesDeleted INT  NOT NULL,
    srNumFilesModified INT  NOT NULL
);

CREATE TABLE LINK (
    liID INT  NOT NULL GENERATED ALWAYS AS IDENTITY 
    (START WITH 1, INCREMENT BY 1) CONSTRAINT LINK_PK PRIMARY KEY,
    lifiID INT  NOT NULL,
    liLINKEDFILEID INT NOT NULL,
	CONSTRAINT lifiID_fk FOREIGN KEY (lifiID) REFERENCES FAFILE(fiID) 
);

CREATE TABLE FA_USER (
    usID INT CONSTRAINT FA_USER_PK PRIMARY KEY,
    usName CHAR(25) NOT NULL,
    usFirstLogin SMALLINT NOT NULL DEFAULT 0,
    usLockOut TIMESTAMP
);

CREATE TABLE LOGIN (
    loID INT  NOT NULL GENERATED ALWAYS AS IDENTITY 
    (START WITH 1, INCREMENT BY 1) CONSTRAINT LOGINS_PK PRIMARY KEY,
    lousID INT  NOT NULL,
    loDate TIMESTAMP  NOT NULL,
    loSuccess SMALLINT NOT NULL,
    CONSTRAINT lousID_fk FOREIGN KEY (lousID) REFERENCES FA_USER(usID)
);

CREATE TABLE ACTIONLOG (
    alID INT  NOT NULL GENERATED ALWAYS AS IDENTITY 
    (START WITH 1, INCREMENT BY 1) CONSTRAINT ACTIONLOG_PK PRIMARY KEY,
    alDate TIMESTAMP  NOT NULL,
    alType VARCHAR(10) NOT NULL,
    alusID INT NOT NULL    
);

CREATE TABLE MEMO (
    meID INT  NOT NULL GENERATED ALWAYS AS IDENTITY 
    (START WITH 1, INCREMENT BY 1) CONSTRAINT MEMO_PK PRIMARY KEY,
    meDate TIMESTAMP NOT NULL,
    meText VARCHAR(10000) NOT NULL,
    mefiID INT NOT NULL,
    CONSTRAINT mefiID_fk FOREIGN KEY (mefiID) REFERENCES FAFILE(fiID)    
);

CREATE TABLE TICKLER (
    tiID INT NOT NULL GENERATED ALWAYS AS IDENTITY 
    (START WITH 1, INCREMENT BY 1) CONSTRAINT TICKLER_PK PRIMARY KEY,
    tifiID INT  NOT NULL,
    tiDate TIMESTAMP  NOT NULL,
    tiAction VARCHAR(300)  NOT NULL,
    tiResolved SMALLINT NOT NULL,
   	CONSTRAINT tifiID_fk FOREIGN KEY (tifiID) REFERENCES FAFILE(fiID)
);
    
CALL SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(
    'derby.connection.requireAuthentication',
    'true');    

CALL SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(
    'derby.authentication.provider',
    'BUILTIN');

CALL SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(
    'derby.user.superadmin',
    'Sa123');

CALL SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(
    'derby.user.admin',
    'Ad123');

CALL SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(
    'derby.user.user',
    'Us123');

CALL SYSCS_UTIL.SYSCS_SET_DATABASE_PROPERTY(
    'derby.user.guest',
    'Gu123');

INSERT INTO FA_USER(usID, usName) values(1, 'Admin');
INSERT INTO FA_USER(usID, usName) values(2, 'User');	
INSERT INTO FA_USER(usID, usName) values(3, 'Guest')